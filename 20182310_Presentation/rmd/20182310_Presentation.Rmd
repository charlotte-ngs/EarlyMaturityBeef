---
title: "Breeding strategies for early maturity in beef cattle"
author: "Silvan Wyss"
date: "11/22/2018"
output: beamer_presentation
header-includes:
   #- \setbeameroption{hide notes} # notes are not shown
  #- \setbeameroption{show notes}   # notes are shown after slide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

## Content

* Topic and goal Master Thesis

* Method and purpose of first Results

* First Results

* Outlook

\note{
Welcome to my presentation about my master thesis, my name is Silvan.
I am here tell you what my master thesis is about, how I got my first results and what they are and what I want to do next.
}

## Goal

* Predicting: Which strategy is suitable to breed for early maturity in beef cattle?

* Here maturity is readiness for slaughter.

* Increased performence in early maturity --> decreased costs.

\note{
The goal of my master thesis is to predict by using models, which breeding strategy will be most suitable to breed for early maturity in beef cattle.
Here it is important that you remember: With early maturity I mean the early readiness for slaughter.
This trait is an economically important trait for beef cattle breeders.
For example, imagine two beef carcasses which are exactly the same and get exatly the same price. 
For one carcass an animal has lived 250 d and for the other an animal has lived 230 d. 
It is obvious that the one which only lived for 230 d led to much less costs for the breeder than the one which lived for 250 d.
This animal is the one which is earlier mature than the other and this is also the animal that you should select with the breeding strategy.
}


## Strategies

**1. Using carcass fat as auxilliary trait.**

**2. Using an index over carcass traits.**

\note{
However, as you can see it is not a trait which you can measure easily. This makes breeding for it difficult.
Probably due this reason breeding for early maturity is not established in any major breeding program.
Even the word early maturity has not been present in any scientific paper I read about beef breeding.
Nevertheless my supervisors have found 4 possible strategies to breed for early maturity.
I will evaluate the two most feasible and promising strategies in my master thesis.
In the first strategy you breed for early maturity in breeding for the carcass trait carcass fat.
The second strategy is not implemented yet and tries to use an index over all breeding values for multiple carcass traits to breed for early maturity.
}

## Carcass traits

* Data from Proviande

* Carcass fat (CF) -> How fatty?

* Carcass conformation (CC) -> How meaty?

* Carcass weight (CW) -> How heavy?

* Calves (c) = < 180 d old

* Adults (a) = > 180 < 701 d old

\note{
Both are very promising because the data which they use is already available. 
Since 1992 Proviande routineley records data from beef carcass traits.
These carcass traits are carcass fat, carcass conformation and carcass weight. 
Of all of them there already exist two breeding values. One for carcasses which were calves and one for carcasses which were adults (cows not included)).
}

## 2. Strategy (index)

* Index as selection criterion

* Main result until this stage of master thesis

$$I=a^Tu$$

where 

$a$ is the vector of economic values,

$u$ is the vector of estimated breeding values.

\note{
As the first strategy is already established I had first to create the basis for the second strategy to compare them.
In the second strategy the selection is based on an index, including all six estimated breeding values for carcass traits and six economic weighing factors.
It should allows to select the most profit yielding animal.
The economic weights determine how important the trait is for the profit.
The index is the main result I have until this stage of the thesis.
The estimated breeding values are available, but the economic values not.
My task was to compute the economic values to produce an index.
There I assume that breeding occurs within breeds which requires a separate index for each beef cattle breed.
To get the best overview on all beef breeds I chose to compute the index for the breeds Angus and Limousin, which are very different in carcass traits.
}

# Economic values

* Unit Sfr. / breeding value unit (e.g. Sfr. / carcass fat class)

* Model potential increase in population mean -> scaling up to one unit

* 

\note{
Economic values tell you how much more money you get if a trait increases by a unit.
This money is determined by the payment system CHTAX.
CHTAX gives me a price differences per kg for the ranges in the different carcass categories.
For example the price per kilogramm is higher for the carcass class 3 than 2.
Therefore I had to modell this increase in the whole population and look how the mean price changes in the population in comparison to the initial population.
I will show you how at the example of the trait carcass fat in the breed Angus and for adults.
There I knew the population mean and standard deviation which I used to construct a normal distribution for this population.
}

## Initial Population

```{r, message=FALSE, warning=FALSE}
library(ggplot2)
library(knitr)
library(kableExtra)
#Vectors of animal numbers Carcass fat 
#Angus with a=adults and c=calves.
Ancfc <- c(189,706,935,125,2)
Ancfa <- c(802,3415,15673,6314,481)
#Limousin with a=adults and c=calves.
Lmcfc <- c(735,1504,1419,72,0)
Lmcfa <- c(5102,21958,50705,7169,148)
#frequencies Carcass fat
#Angus with a=adults and c=calves.
Ancfc <- Ancfc/sum(Ancfc)
Ancfa <- Ancfa/sum(Ancfa)
#Limousin with a=adults and c=calves.
Lmcfc <- Lmcfc/sum(Lmcfc)
Lmcfa <- Lmcfa/sum(Lmcfa)

#Values Carcass fat classes
Vcf <- c(1:5)

AncfaS <- 0.74
AncfaM <- 3.1

x <- data.frame(Class=Vcf,frequency=Ancfa)
g <- ggplot(x,aes(Class,frequency,linetype="Mean"))
g + stat_function(fun = dnorm, args = list(mean = AncfaM, sd = AncfaS), aes(linetype="Initial distribution"))+
  stat_function(fun = dnorm, args = list(mean = AncfaM+0.1, sd = AncfaS),aes(linetype="New distribution"))+
    scale_linetype_manual(values=c("solid","dashed"), guide = guide_legend(title=NULL))+
  theme_classic()
```

\note{
Here you can see the initial distribution, the mean is at class 3.
From the payment system I knew how the classes are priced.
Then I installed thresholds in the distribution which mark where the price changes.
Which was about here and there.
Using the frequencies which is the area under the graphic and multiplying it with the price I could compute the mean price per kg carcass weight.
Then I did the same for the new distribution with an increased population mean by 0.1 fat classes.
The difference between the two prices gave me the economic weight.
}

## Economic weights

```{r economicweights}
library(knitr)
library(dplyr)
library(tidyr)
LM <- "~/Documents/EarlyMaturityBeef/20182310_Presentation/rmd/LM_economic_values"
LM <- read.table(file = LM, sep=";", header=TRUE)
LM <- gather(LM,"Trait","Limousin")

AN  <- "~/Documents/EarlyMaturityBeef/20182310_Presentation/rmd/AN_economic_values"
AN  <- read.table(file = AN, sep=";", header=TRUE)
AN <- gather(AN,"Trait","Angus")

table <- inner_join(AN, LM, by="Trait")
table$Trait <- c("Calves Conformation [Srf./Class]", "Adults Conformation [Srf./Class]", "Calves Fat [Srf./Class]", "Adults Fat [Srf./Class]", "Calves Weight [Srf./kg]", "Adults Weight [Srf./kg]")
kable(table,booktabs=T, digits=2)
table
```

\note{

}

## Corrected for trait unit

```{r economicweights}
library(knitr)
library(dplyr)
library(tidyr)
library(readr)
SD  <- "~/Documents/EarlyMaturityBeef/20182310_Presentation/rmd/mean_sd.csv"
SD  <- read_csv2(file = SD)
SD
SD$Sd
SD_LM <- SD[1:6,"Sd"]
SD_AN <- SD[7:12,"Sd"]

is.numeric(c(SD_LM[4,],SD_LM[3,],SD_LM[2,],SD_LM[1,],SD_LM[6,],SD_LM[5,]))
as.numeric(c(SD_LM[4,],SD_LM[3,],SD_LM[2,],SD_LM[1,],SD_LM[6,],SD_LM[5,]))

LM <- "~/Documents/EarlyMaturityBeef/20182310_Presentation/rmd/LM_economic_values"
LM <- read.table(file = LM, sep=";", header=TRUE)
LM <- gather(LM,"Trait","Limousin")
LM
LM$Limousin <- LM$Limousin*as.numeric(c(SD_LM[4,],SD_LM[3,],SD_LM[2,],SD_LM[1,],SD_LM[6,],SD_LM[5,]))

AN  <- "~/Documents/EarlyMaturityBeef/20182310_Presentation/rmd/AN_economic_values"
AN  <- read.table(file = AN, sep=";", header=TRUE)
AN <- gather(AN,"Trait","Angus")
AN
as.numeric(c(SD_AN[4,],SD_AN[3,],SD_AN[2,],SD_AN[1,],SD_AN[6,],SD_AN[5,]))
AN$Angus <- AN$Angus*as.numeric(c(SD_AN[4,],SD_AN[3,],SD_AN[2,],SD_AN[1,],SD_AN[6,],SD_AN[5,]))
AN$Angus



table <- inner_join(AN, LM, by="Trait")
table$Trait <- c("Calves Conformation", "Adults Conformation", "Calves Fat", "Adults Fat", "Calves Weight", "Adults Weight")
kable(table,booktabs=T, digits=2)
table
```

\note{
Here you can see that the economically most important trait in Angus is carcass fat in calves.
}

## Genetic gain

Dependent on

* Generation intervall

* Selection Intensity

* Standard Deviation of the selection criterion

* Accuracy of the selection criterion

* Selection criterion here = Index or Estimated breeding value for carcass fat.

\note{
Now I have got the two strategies which should help to breed for early maturity.
The next and final step in my master thesis will be to evaluate the two strategies
To do so, I will use a well-established tool: The genetic gain. 
The genetic gain predicts the development of traits under a modelled selection scenarium. 
Usually it is expressed in trait unit per year. 
The genetic gain is dependent on the generation intervall which determines how fast selection occurs, 
on the selection intensity, which determines how large the proportion of the selected population is which will produce the offspring for the next generation, 
on the standard deviation of selected criterion in the population which is the potential for breeding 
and on the accuracy of selection which is a measure of how similar the selected parents are to their progeny in the selection criterion.

These results will help to predict how suitable the two strategies are to breed for early maturity.
Thank you for your attention.
}


