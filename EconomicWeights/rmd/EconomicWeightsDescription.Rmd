---
title: "EconomicWeightsDescription"
author: "Silvan"
date: "5 10 2018"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Economic weights are factors to produce an aggregate genotype from multiple traits.
There is one economical weight per involved trait.
The economical weight per trait is the change in profit (Sfr.) per additional unit of the trait as mean in the population.

$$a=\frac{\Delta_p}{\Delta_{\mu}}$$

$a$ is the economic value.

$\Delta$ is the difference of the underscore variable.

$p$ is the profit in Sfr.

$\mu$ is the population mean in unit of trait.

Here the aggregate genotype consists of the traits carcass fat, carcass conformation and carcass weight.
Consequently the three traits need an economical weight each.
Also aggregate genotypes have to be computed for each breed and animal group separateley.
As an example the economic values will appear for the most distinct breeds, Angus and Limousin and the group stirks.

## Carcass fat
The trait carcass fat has the unit carcass fat class (see table???).
Therefore the economical weight for carcass fat is the additional profit per unit of carcass fat class.
I choose the unit Swiss Francs (Sfr.) per 0.1 carcass fat class for the economic value of carcass fat ($\Delta_{\mu} = 0.1$).

$\Delta_p$ in turn is

$$\Delta_p=r_1^Tp-r_0^Tp$$

$r$ is the vector of population shares belonging to each carcass fat class.

$p$ is the vector of price change per kg for each carcass fat class (see table )

$T$ means, it is the transpose.

$0$ indicates the initial population.

$1$ indicates the population after the change in population mean of 0.1.


I know the initial distribution $r_0$ of the population over the carcass fat scores from the data of Qualitas AG.
The distribution is discrete, which means I know the share of the population within each carcass fat class (see figure \@ref(fig:InitialSharesCF)).

```{r InitialSharesCF, echo=FALSE, fig.cap="Population shares for each carcass fat class in Angus and Limousin calves and stirks (Kunz, 2018)"}
library(knitr)
library(kableExtra)
#Vectors of animal numbers Carcass fat 
#Angus with a=stirks and c=calves.
Ancfc <- c(189,706,935,125,2)
Ancfa <- c(802,3415,15673,6314,481)
#Limousin with a=stirks and c=calves.
Lmcfc <- c(735,1504,1419,72,0)
Lmcfa <- c(5102,21958,50705,7169,148)
#Shares Carcass fat
#Angus with a=stirks and c=calves.
Ancfc <- c(189,706,935,125,2)/sum(Ancfc)
Ancfa <- c(802,3415,15673,6314,481)/sum(Ancfa)
#Limousin with a=stirks and c=calves.
Lmcfc <- c(735,1504,1419,72,0)/sum(Lmcfc)
Lmcfa <- c(5102,21958,50705,7169,148)/sum(Lmcfa)

#Values Carcass fat classes
Vcf <- c(1:5)
#Means (M)
#Angus
AncfcM <- sum(Vcf*Ancfc)
AncfaM <- sum(Vcf*Ancfa)
#Limousin
LmcfcM <- sum(Vcf*Lmcfc)
LmcfaM <- sum(Vcf*Lmcfa)

#Standard deviations (S)
#Angus
AncfcS <- 0.76
AncfaS <- 0.74
#Limousin
LmcfcS <- 0.78
LmcfaS <- 0.71


#define number of rows
#x <- cbind(Vcf,Ancfc,Ancfa,Lmcfc,Lmcfa)
#colnames(x) <- c("class", "ANcalves", "ANstirks", "LMcalves", "LMstirks")
#kable(x, booktabs=T, caption="Population shares for each carcass fat class in Angus and Limousin calves and stirks (Kunz, 2018)")
#x <- as.data.frame(x)
# settings barplot
library(ggplot2)
theme_set(theme_classic())
#set dataframe
x <-data.frame(Class=rep(c(1:5),times=2*2),Category=rep(c("AN", "LM"),each=10), Share=c(Ancfc,Ancfa,Lmcfc,Lmcfa))
x$Group <- rep(rep(c("Calves","Adults"),each=5),times=2)
# Plot
g <- ggplot(x,aes(Class,Share))
g +facet_grid(~Group) + geom_bar(stat="identity", width=0.5, aes(fill=Category), position="dodge")+
# To specify a different mean or sd, use the args parameter to supply new values
  stat_function(fun = dnorm, args = list(mean = AncfaM, sd = AncfaS))+
  theme_classic()
```

```{r PriceCF, echo=F}
# Mean price minus stirks / kg carcass weight
# mean price plus or minus for different carcass fat classes from Proviande 2018, week 33.
library(knitr)
z<-data.frame(class=c("1","2","3","4","5"))
x<-data.frame(MT=c(-0.9,-0.3,0,-0.3,-0.7), 
              OB=c(-0.9, -0.3,0,-0.4,-0.9), RG=c(-0.9,-0.3,0,-0.5,-1))
y<-as.matrix(x)
#compute mean over categories
x$mean<-rowMeans(y)
x<-cbind(z,x) 
#defintion of variable
cfap <- x$mean
#Mean price minus calves / kg carcass weight
cfcp <- c(-1.5,-0.6,0,-0.4,1)
x<-cbind(z,cfap,cfcp)
colnames(x) <- c("class", "stirks","calves")
kable(x, digits=1, caption="Price change in Sfr. per kg carcass weight for each carcass fat class in stirks and calves (Proviande, 2018).")
```
@Proviande2018

The price change $p$ for calves comes from the pricing system CHTAX for the slaughter category KV and the one from stirks is the mean of the slaughter categories MT, OB and RG (see table \@ref(tab:PriceCF)).

$r_1$ could be computed in shifting the distribution until the mean increased by 0.1.
Changing the mean is difficult without changing the distribution shape for a discrete distribution.
Therefore I will use the assumption that carcass fat class is normally distributed in the population.

However the borders of the normal distribution are not clear.
For example, should you set the thresholds of class 1 at 0.5 and 1.5 or at 0 and 1?
I used a trick to get the thresholds of the normal distribution.
I knew the shares of the initial population and derived from the shares, which thresholds would be necessary in a normal distribution to get the right shares per class.

I got the thresholds of the initial distribution by the R-command `qnorm()`. 
This command gave me the quantil of the area under the normal distribution.
The area is the share of animals which belong to specific carcass fat classes.

Afterwards I need to get the shares of the normal distribution after the change of mean.
I used the command `pnorm()` using the values of the t to get back the shares, which is $r_1$.

