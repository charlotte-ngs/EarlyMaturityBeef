---
title: "Compute Index Values"
output: html_notebook
---

## Disclaimer
This notebook contains a few tests about how to compute an index for a set of animals.


## Resources
We start with a few experiments from https://stackoverflow.com/questions/41247487/product-of-several-columns-on-a-data-frame-by-a-vector-using-dplyr

```{r}
tbl <- tibble::data_frame(
  letters = c("A", "B", "C", "D"),
  col1 = c(3, 3, 2, 3),
  col2 = c(2, 2, 3, 1),
  col3 = c(4, 1, 1, 3)
)
tbl
```

Then we define a weight

```{r}
vec_weigth <- c(1:3)
```

First look at demo of `tidyr::so-17481212`. 

```{r eval=FALSE}
demo(tidyr::so-17481212)
```

Unroll the the single steps into

```{r}
library(tidyr)
library(dplyr)
race <- read.table(header = TRUE, check.names = FALSE, text = "
Name    50  100  150  200  250  300  350
Carla  1.2  1.8  2.2  2.3  3.0  2.5  1.8
Mace   1.5  1.1  1.9  2.0  3.6  3.0  2.5
Lea    1.7  1.6  2.3  2.7  2.6  2.2  2.6
Karen  1.3  1.7  1.9  2.2  3.2  1.5  1.9")
race
```

First, we do a `gather()`-step

```{r}
race %>%
   gather(Time, Score, -Name, convert = TRUE)
```

Add a step using the `arrange()` function.

```{r}
race %>%
   gather(Time, Score, -Name, convert = TRUE) %>%
   arrange(Name, Time)
```


Compute dot product of each row with `vec_weight` leads to 

```{r}
tmp <- tbl %>%
  gather(variable, value, -letters) %>%
  group_by(letters) %>%
  mutate(value = value * vec_weigth) %>%
  spread(variable, value)
tmp # %>%
#   select(- letters)
```

How can we compute the sum of the numeric columns

```{r}
tmp %>%
  as.matrix()

```

```{r}
iris %>% 
  mutate(sumVar = select(., contains("Sepal")) %>% rowSums()) %>% 
  head
```


## Functional Programming
Try to use the `purrr::map()`-function for an example given at: https://campus.datacamp.com/courses/writing-functions-in-r/functional-programming?ex=1

```{r}
library(purrr)
(means <- map_dbl(mtcars, mean))
(medians <- map_dbl(mtcars, median))
```

