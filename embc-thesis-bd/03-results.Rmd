# Results {#results}

There are results for the computation of the index to determine the strategy *Index over carcass traits*, the genetic gains, the rank correlations and the literature reviews of the strategies *Deviation in age at slaughter* and *Growth models*.
All of these results are presented for the breeds Angus and Limousin.

## Index

The index is determined by the economic weights for the carcass traits carcass fat, carcass conformation and carcass weight, each of *adults* and *calves* (see Table ??).
Additionally these weights are shown corrected for the trait's genetic standard deviation.
This allows to compare the importance of the different traits in the index (see Figure ??).

```{r ecweightstab}
library(knitr)
AN_economic_weights_file <- system.file("extdata","AN_economic_values", package="Exemplary")
AN_economic_weights <- read.table(file = AN_economic_weights_file, sep=";", header=TRUE)
AN_economic_weights <- as.matrix(AN_economic_weights)
AN_economic_weights <- as.vector(AN_economic_weights)
LM_economic_weights_file <- system.file("extdata","LM_economic_values", package="Exemplary")
LM_economic_weights <- read.table(file = LM_economic_weights_file, sep=";", header=TRUE)
LM_economic_weights <- as.matrix(LM_economic_weights)
LM_economic_weights <- as.vector(LM_economic_weights)
table <- data.frame(Trait= c("Calves conformation [Sfr. / conformation class]", "Adults conformation [Sfr. / conformation class]", "Calves fat [Sfr. / fat class]", "Adults fat [Sfr. / fat class]", "Calves weight [Sfr. / kg carcass weight]", "Adults weight [Sfr. / kg carcass weight]"),Angus=AN_economic_weights,Limousin=LM_economic_weights)
kable(table, digits=2, booktabs=T,caption="Economic weights in Sfr. per trait unit which determine the index for the strategy Index over carcass traits.")
```

```{r ecweightsgensdfig, fig.cap="Economic weights in Sfr. per genetic standard deviation for all carcass traits."}
library(ggplot2)
AN_economic_weights_file <- system.file("extdata","AN_economic_values", package="Exemplary")
AN_economic_weights <- read.table(file = AN_economic_weights_file, sep=";", header=TRUE)
AN_economic_weights <- as.matrix(AN_economic_weights)
AN_economic_weights <- as.vector(AN_economic_weights)
LM_economic_weights_file <- system.file("extdata","LM_economic_values", package="Exemplary")
LM_economic_weights <- read.table(file = LM_economic_weights_file, sep=";", header=TRUE)
LM_economic_weights <- as.matrix(LM_economic_weights)
LM_economic_weights <- as.vector(LM_economic_weights)
genetic_var_cov <- system.file("extdata","adults_calves_genetic_variances_covariances", package="Exemplary")
genetic_var_cov <- read.table(file = genetic_var_cov, sep=";", header=TRUE)
genetic_var_cov <- as.matrix(genetic_var_cov)
gen_sd <- sqrt(diag(genetic_var_cov))
AN_table <- data.frame(Trait=rep(c("Conformation","Fat","Weight"),each=2), Group=rep(c("Calves","Adults"),times=3),Weight=AN_economic_weights)
AN_table$Weight <- AN_table$Weight*gen_sd

LM_table <- data.frame(Trait=rep(c("Conformation","Fat","Weight"),each=2), Group=rep(c("Calves","Adults"),times=3),Weight=LM_economic_weights)
LM_table$Weight <- LM_table$Weight*gen_sd

table <- rbind(AN_table,LM_table)
table$Breed <- rep(c("Angus","Limousin"),each=6)

g <- ggplot(table,aes(Trait,Weight))
g + geom_bar(stat="identity", width=0.5,aes(fill=Breed),position="dodge")+
  theme_classic()+theme(text = element_text(size = 15))+
  ylab("Sfr. per genetic standard deviation.")+facet_grid(.~Group)
```

## Genetic Gain

```{r geninputgengain}
library(dplyr)
library(Exemplary)
# import variance covariance dataframes and compute matrix
## genetic
genetic_var_cov <- system.file("extdata","adults_calves_genetic_variances_covariances", package="Exemplary")
genetic_var_cov <- read.table(file = genetic_var_cov, sep=";", header=TRUE)
genetic_var_cov <- as.matrix(genetic_var_cov)
## residual
residual_var_cov <- system.file("extdata","adults_calves_residual_variances_covariances", package="Exemplary")
residual_var_cov <- read.table(file = residual_var_cov, sep=";", header=TRUE)
residual_var_cov <- as.matrix(residual_var_cov)

# herd x year
herdyear_var_cov <- system.file("extdata","adults_calves_herdyear_variances_covariances", package="Exemplary")
herdyear_var_cov <- read.table(file = herdyear_var_cov, sep=";", header=TRUE)
herdyear_var_cov <- as.matrix(herdyear_var_cov)
#residual_var_cov <- residual_var_cov+herdyear_var_cov

# number of offspring
offspring_file <- system.file("extdata","number_of_offspring", package="Exemplary")
male_offspring <- read.table(file = offspring_file, sep=";", header=TRUE) %>%
  select(male)
male_offspring <- as.numeric(male_offspring)
female_offspring <- read.table(file = offspring_file, sep=";", header=TRUE) %>%
  select(female)
female_offspring <- as.numeric(female_offspring)

# proportion selected of offspring
proportionselected_file <- system.file("extdata","proportion_selected", package="Exemplary")
male_proportionselected <- read.table(file = proportionselected_file, sep=";", header=TRUE) %>%
  select(male)
male_proportionselected <- as.numeric(male_proportionselected)
female_proportionselected <- read.table(file = proportionselected_file, sep=";", header=TRUE) %>%
  select(female)
female_proportionselected <- as.numeric(female_proportionselected)

# proportion of adults and calves in offspring
proportion_file <- system.file("extdata","proportion_calves_adults", package="Exemplary")
proportion_adults <- read.table(file = proportion_file, sep=";", header=TRUE) %>%
  select(adults)
proportion_adults <- as.numeric(proportion_adults)
proportion_calves <- read.table(file = proportion_file, sep=";", header=TRUE) %>%
  select(calves)
proportion_calves <- as.numeric(proportion_calves)

# Generation Intervall
generation_intervall <- system.file("extdata","generation_intervall", package="Exemplary")
male_generationintervall <- read.table(file = generation_intervall, sep=";", header=TRUE) %>%
  select(male)
male_generationintervall <- as.numeric(male_generationintervall)
female_generationintervall <- read.table(file = generation_intervall, sep=";", header=TRUE) %>%
  select(female)
female_generationintervall <- as.numeric(female_generationintervall)
```

```{r gengainangus}
economic_weights <- system.file("extdata","AN_economic_values", package="Exemplary")
economic_weights <- read.table(file = economic_weights, sep=";", header=TRUE)
economic_weights <- as.matrix(economic_weights)
economic_weights <- as.vector(economic_weights)

Sfr_AN_index <- compute_genetic_gain_overall_index(genetic_var_cov = genetic_var_cov, residual_var_cov = residual_var_cov, offspring = offspring, proportion_calves = proportion_calves, proportion_adults = proportion_adults,male_proportionselected = male_proportionselected,female_proportionselected = female_proportionselected, male_generationintervall=male_generationintervall,female_generationintervall = female_generationintervall,economic_weights = economic_weights)

Sfr_AN_CF <- compute_genetic_gain_overall_CF(genetic_var_cov = genetic_var_cov, residual_var_cov = residual_var_cov, offspring = offspring, proportion_calves = proportion_calves, proportion_adults = proportion_adults,male_proportionselected = male_proportionselected,female_proportionselected = female_proportionselected, male_generationintervall=male_generationintervall,female_generationintervall = female_generationintervall,economic_weights = economic_weights)

# Loop that produces a matrix with all correlated genetic gains
list_of_traits <- colnames(genetic_var_cov)
mat_correlated_gen_gain <- NULL

for(trait in list_of_traits){
  if (is.null(mat_correlated_gen_gain)){
  mat_correlated_gen_gain <- cbind(trait,compute_genetic_gain_trait(genetic_var_cov = genetic_var_cov, residual_var_cov = residual_var_cov, offspring = offspring, proportion_calves = proportion_calves, proportion_adults = proportion_adults,male_proportionselected = male_proportionselected,female_proportionselected = female_proportionselected, male_generationintervall=male_generationintervall,female_generationintervall = female_generationintervall,economic_weights = economic_weights, trait=trait))
} else {
  mat_correlated_gen_gain <- rbind(mat_correlated_gen_gain,cbind(trait,compute_genetic_gain_trait(genetic_var_cov = genetic_var_cov, residual_var_cov = residual_var_cov, offspring = offspring, proportion_calves = proportion_calves, proportion_adults = proportion_adults,male_proportionselected = male_proportionselected,female_proportionselected = female_proportionselected, male_generationintervall=male_generationintervall,female_generationintervall = female_generationintervall,economic_weights = economic_weights, trait=trait)))
}
}
Trait_AN_index <- mat_correlated_gen_gain
# Loop that produces a matrix with all correlated genetic gains
list_of_traits <- colnames(genetic_var_cov)
mat_correlated_gen_gain <- NULL

for(trait in list_of_traits){
  if (is.null(mat_correlated_gen_gain)){
  mat_correlated_gen_gain <- cbind(trait,compute_genetic_gain_trait_CF(genetic_var_cov = genetic_var_cov, residual_var_cov = residual_var_cov, offspring = offspring, proportion_calves = proportion_calves, proportion_adults = proportion_adults,male_proportionselected = male_proportionselected,female_proportionselected = female_proportionselected, male_generationintervall=male_generationintervall,female_generationintervall = female_generationintervall,economic_weights = economic_weights, trait=trait))
} else {
  mat_correlated_gen_gain <- rbind(mat_correlated_gen_gain,cbind(trait,compute_genetic_gain_trait_CF(genetic_var_cov = genetic_var_cov, residual_var_cov = residual_var_cov, offspring = offspring, proportion_calves = proportion_calves, proportion_adults = proportion_adults,male_proportionselected = male_proportionselected,female_proportionselected = female_proportionselected, male_generationintervall=male_generationintervall,female_generationintervall = female_generationintervall,economic_weights = economic_weights, trait=trait)))
}
}
Trait_AN_CF <- mat_correlated_gen_gain
```

```{r gengainlimousin}
economic_weights <- system.file("extdata","LM_economic_values", package="Exemplary")
economic_weights <- read.table(file = economic_weights, sep=";", header=TRUE)
economic_weights <- as.matrix(economic_weights)
economic_weights <- as.vector(economic_weights)

Sfr_LM_index <- compute_genetic_gain_overall_index(genetic_var_cov = genetic_var_cov, residual_var_cov = residual_var_cov, offspring = offspring, proportion_calves = proportion_calves, proportion_adults = proportion_adults,male_proportionselected = male_proportionselected,female_proportionselected = female_proportionselected, male_generationintervall=male_generationintervall,female_generationintervall = female_generationintervall,economic_weights = economic_weights)

Sfr_LM_CF <- compute_genetic_gain_overall_CF(genetic_var_cov = genetic_var_cov, residual_var_cov = residual_var_cov, offspring = offspring, proportion_calves = proportion_calves, proportion_adults = proportion_adults,male_proportionselected = male_proportionselected,female_proportionselected = female_proportionselected, male_generationintervall=male_generationintervall,female_generationintervall = female_generationintervall,economic_weights = economic_weights)

# Loop that produces a matrix with all correlated genetic gains
list_of_traits <- colnames(genetic_var_cov)
mat_correlated_gen_gain <- NULL

for(trait in list_of_traits){
  if (is.null(mat_correlated_gen_gain)){
  mat_correlated_gen_gain <- cbind(trait,compute_genetic_gain_trait(genetic_var_cov = genetic_var_cov, residual_var_cov = residual_var_cov, offspring = offspring, proportion_calves = proportion_calves, proportion_adults = proportion_adults,male_proportionselected = male_proportionselected,female_proportionselected = female_proportionselected, male_generationintervall=male_generationintervall,female_generationintervall = female_generationintervall,economic_weights = economic_weights, trait=trait))
} else {
  mat_correlated_gen_gain <- rbind(mat_correlated_gen_gain,cbind(trait,compute_genetic_gain_trait(genetic_var_cov = genetic_var_cov, residual_var_cov = residual_var_cov, offspring = offspring, proportion_calves = proportion_calves, proportion_adults = proportion_adults,male_proportionselected = male_proportionselected,female_proportionselected = female_proportionselected, male_generationintervall=male_generationintervall,female_generationintervall = female_generationintervall,economic_weights = economic_weights, trait=trait)))
}
}
Trait_LM_index <- mat_correlated_gen_gain
# Loop that produces a matrix with all correlated genetic gains
list_of_traits <- colnames(genetic_var_cov)
mat_correlated_gen_gain <- NULL

for(trait in list_of_traits){
  if (is.null(mat_correlated_gen_gain)){
  mat_correlated_gen_gain <- cbind(trait,compute_genetic_gain_trait_CF(genetic_var_cov = genetic_var_cov, residual_var_cov = residual_var_cov, offspring = offspring, proportion_calves = proportion_calves, proportion_adults = proportion_adults,male_proportionselected = male_proportionselected,female_proportionselected = female_proportionselected, male_generationintervall=male_generationintervall,female_generationintervall = female_generationintervall,economic_weights = economic_weights, trait=trait))
} else {
  mat_correlated_gen_gain <- rbind(mat_correlated_gen_gain,cbind(trait,compute_genetic_gain_trait_CF(genetic_var_cov = genetic_var_cov, residual_var_cov = residual_var_cov, offspring = offspring, proportion_calves = proportion_calves, proportion_adults = proportion_adults,male_proportionselected = male_proportionselected,female_proportionselected = female_proportionselected, male_generationintervall=male_generationintervall,female_generationintervall = female_generationintervall,economic_weights = economic_weights, trait=trait)))
}
}
Trait_LM_CF <- mat_correlated_gen_gain
```

```{r gengainagggenotypefig, fig.cap="Genetic gain of Angus and Limousin when selecting for the strategies Index over carcass traits and Carcass fat as auxilliary trait."}
library(ggplot2)
x <-data.frame(Gain=c(Sfr_AN_index,Sfr_LM_index,Sfr_AN_CF,Sfr_LM_CF),Breed=rep(c("Angus", "Limousin"),times=2),Strategy=rep(c("Index over carcass traits","Carcass fat as auxilliary trait"),each=2))
# Plot
g <- ggplot(x,aes(Strategy,Gain))
g + geom_bar(stat="identity", width=0.5,aes(fill=Breed),position="dodge")+
  theme_classic()+theme(text = element_text(size = 15))+
  ylab("Genetic gain in Sfr. / y")

```

```{r corrgengaintab}
library(ggplot2)
library(varhandle)
library(knitr)
library(kableExtra)
table_AN_index <- as.data.frame(Trait_AN_index)
table_AN_index$V2 <- unfactor(table_AN_index$V2)
table_LM_index <- as.data.frame(Trait_LM_index)
table_LM_index$V2 <- unfactor(table_LM_index$V2)
table_AN_CF <- as.data.frame(Trait_AN_CF)
table_AN_CF$V2 <- unfactor(table_AN_CF$V2)
table_LM_CF <- as.data.frame(Trait_LM_CF)
table_LM_CF$V2 <- unfactor(table_LM_CF$V2)
names <- data.frame(Trait=c("Calves conformation [Conformation class / y]", "Adults conformation [Conformation class / y]", "Calves fat [Fat class / y]", "Adults fat [Fat class / y]", "Calves weight [kg carcass weight / y]", "Adults weight [kg carcass weight / y]"))
table <- cbind(names,table_AN_CF$V2,table_LM_CF$V2,table_AN_index$V2,table_LM_index$V2)
colnames(table) <- c("Trait","Angus","Limousin","Angus","Limousin")
kable(table, digits=3, booktabs=T, caption="Correlated genetic gains of Angus and Limousin when selecting for the strategy Index over carcass traits.")%>%
 add_header_above(c("","Carcass fat as auxilliary trait"=2,"Index over carcass traits"=2))

```


```{r corrgengainpergensdangusfig, fig.cap="Correlated genetic gains per genetic standard deviation of Angus when selecting for the strategies Index over carcass traits and Carcass fat as auxilliary trait."}
# Per genetic standard deviation
library(ggplot2)
library(varhandle)
x <- rbind(Trait_AN_index,Trait_AN_CF)
x <- as.data.frame(x)
x$Strategy <- rep(c("Index over carcass traits","Carcass fat as auxilliary trait"),each=6)
x$Group <- rep(rep(c("Calves","Adults"),times=3),times=2)
x$Trait <- rep(rep(c("Conformation","Fat","Weight"),each=2),times=2)
colnames(x)[2] <- "Gain"
x$Gain <- unfactor(x$Gain)

SD <- as.matrix(genetic_var_cov)
SD <- diag(SD)
SD <- sqrt(SD)
x$SD <- rep(SD,times=2)
x$GainSD <- x$Gain/x$SD

g <- ggplot(x,aes(Trait,GainSD))
g + geom_bar(stat="identity", width=0.5,aes(fill=Group),position="dodge")+
  theme_classic()+theme(text = element_text(size = 15))+
  ylab("Genetic gain in trait unit/y")+facet_grid(.~Strategy)
```

```{r corrgengainpergensdlimousinfig, fig.cap="Correlated genetic gains per genetic standard deviation of Limousin when selecting for the strategies Index over carcass traits and Carcass fat as auxilliary trait."}
# Per genetic standard deviation
library(ggplot2)
library(varhandle)
x <- rbind(Trait_LM_index,Trait_LM_CF)
x <- as.data.frame(x)
x$Strategy <- rep(c("Index over carcass traits","Carcass fat as auxilliary trait"),each=6)
x$Group <- rep(rep(c("Calves","Adults"),times=3),times=2)
x$Trait <- rep(rep(c("Conformation","Fat","Weight"),each=2),times=2)
colnames(x)[2] <- "Gain"
x$Gain <- unfactor(x$Gain)

SD <- as.matrix(genetic_var_cov)
SD <- diag(SD)
SD <- sqrt(SD)
x$SD <- rep(SD,times=2)
x$GainSD <- x$Gain/x$SD

g <- ggplot(x,aes(Trait,GainSD))
g + geom_bar(stat="identity", width=0.5,aes(fill=Group),position="dodge")+
  theme_classic()+theme(text = element_text(size = 15))+
  ylab("Genetic gain in trait unit/y")+facet_grid(.~Strategy)
```

## Rank Correlations







