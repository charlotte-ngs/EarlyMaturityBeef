---
output:
  pdf_document: default
  html_document: default
---
# Material and Methods {#matandmeth}
Based on the earlier made observation in chapter \@ref(intro), it is important to improve __early maturity__ in Swiss beef cattle. 
One possibility for improving a certain trait is to use this trait in a breeding program. 
To include a certain trait in a breeding program it is important that the trait is preciseley defined and efficiently measurable.

## Definition of Early Maturity {#defem}
In the context of this project we use the following definition of "early maturity". Animals are earlier mature if they reach the state of carcass maturity faster than others. 
Animals reach carcass maturity when their carcass does not get any markdowns due to insufficient or excessive carcass fat. 

Carcass price markdowns are dependent on the payment system of the slaughterhouse.
Since 1994 the payment system of Swiss slaughterhouses for beef cattle is based on the classification system called CHTAX [Kaufmann1995]. 

## Beef carcass classification system CHTAX {#CHTAX}
The Swiss meat industry association "Proviande" is responsible for the implementation of CHTAX in Swiss slaughterhouses. 
In slaughterhouses Proviande employees classify beef either as live or dead animals to determine their price.
The first step in the classification system CHTAX is to assign the animal to a slaughter category. 
The distinct slaughter categories differ in age at slaughter, sex and weight.
Proviande employees either calculate age at slaughter as the time between birth and slaughter or determine it based on the number of incissors (front teeth) the animal has developed.
The more incissors the physiologically older the animal. Table \@ref(tab:slaughtercategory) contains a list of carcass categories used in CHTAX.

The choice of slaughter category determines the basis price of an animal per kilogram carcass weight (CW) or live weight (LW).
The law "Schlachtgewichtsverordnung" of the the Swiss federal departement EDI defines how slaughterhouses have to determine the carcass weight [@EDI2013, S.1]. Eventuell hier noch ein Bild eines Schlachtkörpers zeigen.
The live weight is defined as the body weight of the living animal but visually corrected by the size and filling grade of the rumen, the size of udder and skin, the transport to the slaughterhouse, the state of gestiation and the carcass maturity [@Proviande2015].

```{r slaughtercategory, echo=FALSE, results='asis'}
tbl_category <- tibble::data_frame(abbreviation=c("KV", "JB", "MT", "MA", "OB", "RG", "RV", "VK"), 
                                   "slaughter category"=c("calves", "young cattle", "young bulls", "bulls or steers", 
                                              "young steers", "young heifers", "heifers or young cows", "cows"), 
                                   description=c("<161 days old", " >161 days <11 months old, <320 kg live weight", 
                                              ">161 days old, no incissors", 
                                              ">161 days old, >0 incissors for bulls, >4 incissors for steers", 
                                              ">161 days old, <5 incissors", ">161 days old, <5 incissors", 
                                              ">161 days old, >4 incissors for heifers, <5 incissors for young cows", 
                                              ">161 days old"), "base price of carcass conformation class T in Sfr. / kg carcass (*live) weight" = c("14.2","*6.3", "8.8", "6.2", "8.8", "8.8", "7.7", "7.5"))

# convert data_frame into a hux
ht_prop_sel <- huxtable::as_hux(tbl_category)
# specify total width of table compared to textwidth
huxtable::width(ht_prop_sel) <- .8
# specify width of each column
huxtable::col_width(ht_prop_sel) <- c(.2, .3, .5)
# column content is wrapped
huxtable::wrap(ht_prop_sel) <- TRUE
# add column names
ht_prop_sel <- huxtable::add_colnames(ht_prop_sel)
# borders are added
ht_prop_sel <- huxtable::set_all_borders(ht_prop_sel, 1)
# cell content is aligned to the top
huxtable::valign(ht_prop_sel) <- "top"
# setting the caption
if (knitr::is_html_output()){
  stab_flag <- '(#tab:slaughtercategory)'
} else {
  stab_flag <- '(\\#tab:slaughtercategory)'
}
ht_prop_sel <- huxtable::set_caption(ht=ht_prop_sel, 
                                     paste(stab_flag, 'Slaughter categories in CHTAX'))
ht_prop_sel

```

The second step in the classification system CHTAX is to assign the animal within its slaughter category to a carcass conformation class and a carcass fat class.

In this step Proviande employees visually and gropingly classify the carcass into five classes of carcass fat and into five classes of carcass conformation.

Carcass fat and carcass conformation have been introduced as price formation factors in Swiss slaughterhouses, because they suppose to coincide with important price-determining characteristics of beef meat [@Kaufmann1995]. 
Carcass fat when too low has been related at the moment of its introduction to poor tenderness, juiciness and palatability, when too high with increased trimming effort for the slaughterhouse [@Kaufmann1995].
A better carcass conformation in turn has been related to a higher yield of valuable meat pieces [@Proviande2015].

The assigned carcass conformation class depends on the accentuation of certain muscles and on the profile the animals body shows (Figure with living animals from Proviande 2015?).
The meatier the carcass the higher the carcass conformation class.
The lowest carcass conformation class is called X and the highest class is called C.
A detailed description of the distinct carcass conformation classes is available at \@ref(tab:conformationclass).
In combination with the slaughter category the carcass conformation class determines the basis price of an animal per kilogram carcass or live weight.
As an example \@ref(tab:conformationclass) the basis prices per kilogram carcass and live weight for a carcass of the slaughter category young bulls (MT) are available.
The determination of beef carcass weight and live weight at slaughterhouses is legally specified.
The law "Schlachtgewichtsverordnung" of the the Swiss federal departement EDI defines how slaughterhouses have to assess the carcass weight [@EDI2013, S.1]. Eventuell hier noch ein Bild eines Schlachtkörpers zeigen.
Proviande defines live weight as the body weight of the living animal but visually corrected by the size and filling grade of the rumen, the size of udder and skin, the transport to the slaughterhouse, the state of gestiation and the carcass maturity [@Proviande2015].

The determination of carcass fat class can further change the base price per kilogramm carcass weight or live weight.
Proviande employees determine the class of carcass fat by the area and the accentuation of fat that covers the carcass (\@ref(tab:fatclass).
The least fatty carcasses belong to carcass fat class 1 and the fattiest carcasses belong to carcass fat class 5.
The optimal carcass fat class is 3.
When a carcass does not belong to class 3, the carcass gets a markdown in Swiss Francs (Sfr.) per kilogramm carcass or live weight.
As an example \@ref(tab:fatclass) the markdowns per kilogram carcass weight for a carcass of the slaughter category MT are available.


```{r fatclass, echo=FALSE}
tbl_fatclass <- tibble::data_frame("carcass fat class" = c("1", "2", "3", "4", "5"), "carcass fat coverage"=c("uncovered", "partially covered", "evenly covered", "strongly covered", "excessiveley fatty"), "description"=c("no fat coverage; grips not developed","light fat coverage; muscels partially visible; all grips slightly tangible", "average even fat coverage; muscles generally covered; all grips tangible and robust", "strong fat coverage; excessive fat deposition; grips strongly developed", "fat coverage generally excessive; bulging fat formations; all grips very strongly developed"), "markdown for MT in Sfr. / kg carcass weight" = c("-0.9","-0.3","0","-0.3","-0.7"))

# convert data_frame into a hux
ht_prop_sel <- huxtable::as_hux(tbl_fatclass)
# specify total width of table compared to textwidth
huxtable::width(ht_prop_sel) <- .8
# specify width of each column
huxtable::col_width(ht_prop_sel) <- c(.2, .3, .5)
# column content is wrapped
huxtable::wrap(ht_prop_sel) <- TRUE
# add column names
ht_prop_sel <- huxtable::add_colnames(ht_prop_sel)
# borders are added
ht_prop_sel <- huxtable::set_all_borders(ht_prop_sel, 1)
# cell content is aligned to the top
huxtable::valign(ht_prop_sel) <- "top"
# setting the caption
if (knitr::is_html_output()){
  stab_flag <- '(#tab:fatclass)'
} else {
  stab_flag <- '(\\#tab:fatclass)'
}
ht_prop_sel <- huxtable::set_caption(ht=ht_prop_sel, 
                                     paste(stab_flag, 'Carcass fat classes in CHTAX'))
ht_prop_sel
```



```{r conformationclass, echo=FALSE}
tbl_conformationclass <- tibble::data_frame("carcass conformation class" = c("C", "H", "T", "A", "X"), profile=c("very convex", "convex", "linear", "concave", "very concave"), description=c("leg: accentedly wide; back: accentedly wide and full; shoulder: accentedly pronounced","leg: wide; back: wide and full; shoulder: pronounced", "leg: well developed, quite wide; back: average large; shoulder: accentedly pronounced", "leg: moderateley developed, slim, hollow; back: moderateley developed til slim ; shoulder: flat", "leg: poorly developed, very slim, very hollow; back: slim, thin, pointy wither; shoulder: flat, hollow"), "base price for MT in Sfr. / kg carcass weight"=c("5.55","5.3","4.65","4.2","3.85"))

# convert data_frame into a hux
ht_prop_sel <- huxtable::as_hux(tbl_conformationclass)
# specify total width of table compared to textwidth
huxtable::width(ht_prop_sel) <- 1.2
# specify width of each column
huxtable::col_width(ht_prop_sel) <- c(.2, .3, .8)
# column content is wrapped
huxtable::wrap(ht_prop_sel) <- TRUE
# add column names
ht_prop_sel <- huxtable::add_colnames(ht_prop_sel)
# borders are added
ht_prop_sel <- huxtable::set_all_borders(ht_prop_sel, 1)
# cell content is aligned to the top
huxtable::valign(ht_prop_sel) <- "top"
# setting the caption
if (knitr::is_html_output()){
  stab_flag <- '(#tab:conformationclass)'
} else {
  stab_flag <- '(\\#tab:conformationclass)'
}
ht_prop_sel <- huxtable::set_caption(ht=ht_prop_sel, 
                                     paste(stab_flag, 'Carcass conformation classes in CHTAX'))
ht_prop_sel
```

In conclusion age, number of incissors, sex, carcass conformation, carcass weight and carcass fat all influence the price of a beef carcass in Switzerland.
While age in days, number of incissors, carcass conformation and carcass weight are traits that should be maximal or minimal, sex and carcass fat should be optimal in the range.

Early maturity is only dependent on age at slaughter and carcass fat tough.
For there are two traits at once that influence early maturity, early maturity is not directly measurable.


## Improvement of Early Maturity
Based on the knowledge of beef growth carcass fat could be a usefull trait to derive early maturity from.
Mutterkuh Schweiz, the Swiss beef breeders association, has introduced a breeding value for carcass fat in Summer 2018.
To describe and discuss carcass fat as a trait to derive early maturity, the creation and evaluation procedure of the breeding value carcass fat will here be explained.
The explanations refering to the creation of the breeding value are based on the documentation of Sophie Kunz, geneticist at Qualitas AG [@Kunz2018].

To compute the breeding values a multivariate best linear unbiased prediction (BLUP) model has been used.
BLUP is a statistical model assuming that the breeding value of an animal is the deviation of the genetic additive effect on the phenotypic observation of an animals measurable trait
The phenotypic observation in this case is the class of carcass fat the animal belongs to, as described in \@ref(tab:fatclass).
The genetic additive properties of an animal are not the only effect on the animals phenotypical observation.
An animals phenotypical observation is also dependent on the environmental conditions the animal lives in and on the genetic effects dominance and epistasis.

In BLUP the non genetic additive effects on a phenotypic observation are either known fixed effects or unnkown random effects.
To compute the breeding value for carcass fat the following parameters of the animals environment have been used as fixed effects:
* Proviande carcass classifying employee
* sex (as covariable)
* age and squared age at slaughter
* slaughterhouse

There is only one known random effect used in the model:
* farm x year

The known fixed effects are included in BLUP and are used to separate additive genetic effects from environmental effects.

The next assumption you need is that the heritability ($h^2$) of a trait is valid for all animals.
Then the genetic additive effect is the coefficient of relationship times the heritability times the phenotypic value minus the heritability times the mean value observations of the base population in the same environment defined by the fixed effects.

When one phenotypic record is the only available information on each
animal, the estimated breeding value (ai) for animal i can be calculated as:
a$ i = b(y i − m) [1.3]
where b is the regression of true breeding value on phenotypic performance
and m, as indicated earlier, is the mean performance of animals in
the same management group and is assumed to be known.


The breeding values for carcass fat are based on the knowledge of the carcass fat classifications as described in \@ref(tab:fatclass) and the degrees relationship of beef animals.


